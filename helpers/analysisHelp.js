// const questions = [
//   {
//       "id": 16,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:23:29.572Z",
//       "guest_id": 15,
//       "query": "What is a state?",
//       "tags_selected": [
//           "react",
//           "state"
//       ]
//   },
//   {
//       "id": 17,
//       "room_id": 10,
//       "user_id": 7,
//       "guest_hash": "D5F",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:23:59.682Z",
//       "guest_id": 16,
//       "query": "Can I use hooks with react 360?",
//       "tags_selected": [
//           "hooks",
//           "react"
//       ]
//   },
//   {
//       "id": 18,
//       "room_id": 10,
//       "user_id": 8,
//       "guest_hash": "KkA",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:24:00.804Z",
//       "guest_id": 14,
//       "query": "What is a useEffect?",
//       "tags_selected": [
//           "useeffect"
//       ]
//   },
//   {
//       "id": 19,
//       "room_id": 10,
//       "user_id": 7,
//       "guest_hash": "D5F",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:25:21.607Z",
//       "guest_id": 16,
//       "query": "do you need synergy to use reducers?",
//       "tags_selected": [
//           "reducers"
//       ]
//   },
//   {
//       "id": 20,
//       "room_id": 10,
//       "user_id": 11,
//       "guest_hash": "RZ9",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:31:09.774Z",
//       "guest_id": 17,
//       "query": "Redux",
//       "tags_selected": [
//           "redux"
//       ]
//   },
//   {
//       "id": 21,
//       "room_id": 10,
//       "user_id": 8,
//       "guest_hash": "KkA",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:32:01.692Z",
//       "guest_id": 14,
//       "query": "How do I change the state?",
//       "tags_selected": [
//           "state"
//       ]
//   },
//   {
//       "id": 22,
//       "room_id": 10,
//       "user_id": 8,
//       "guest_hash": "KkA",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:32:09.474Z",
//       "guest_id": 14,
//       "query": "How do I import the CSS file?",
//       "tags_selected": [
//           "css"
//       ]
//   },
//   {
//       "id": 23,
//       "room_id": 10,
//       "user_id": 11,
//       "guest_hash": "RZ9",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:32:20.321Z",
//       "guest_id": 17,
//       "query": "Why does Alex always eat my cookies?",
//       "tags_selected": [
//           "react",
//           "sql",
//           "javascript",
//           "state",
//           "props",
//           "hooks",
//           "reducers",
//           "alex",
//           "my",
//           "cookies"
//       ]
//   },
//   {
//       "id": 24,
//       "room_id": 10,
//       "user_id": 8,
//       "guest_hash": "KkA",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:32:32.567Z",
//       "guest_id": 14,
//       "query": "Enumerate the differences between Java and¬†JavaScript?",
//       "tags_selected": [
//           "differences",
//           "java",
//           "javascript"
//       ]
//   },
//   {
//       "id": 25,
//       "room_id": 10,
//       "user_id": 8,
//       "guest_hash": "KkA",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:32:49.623Z",
//       "guest_id": 14,
//       "query": "What is negative infinity?¬†",
//       "tags_selected": [
//           "negative",
//           "infinity"
//       ]
//   },
//   {
//       "id": 26,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:32:54.123Z",
//       "guest_id": 15,
//       "query": "What is a prop?",
//       "tags_selected": [
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 27,
//       "room_id": 10,
//       "user_id": 8,
//       "guest_hash": "KkA",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:09.898Z",
//       "guest_id": 14,
//       "query": "What is the use of isNaN function?¬†",
//       "tags_selected": [
//           "use",
//           "isnan"
//       ]
//   },
//   {
//       "id": 28,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:13.479Z",
//       "guest_id": 15,
//       "query": "Please tell me what a prop is",
//       "tags_selected": [
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 29,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:22.183Z",
//       "guest_id": 15,
//       "query": "Please tell me what a prop is",
//       "tags_selected": [
//           "state",
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 30,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:25.049Z",
//       "guest_id": 15,
//       "query": "Please tell me what a prop is",
//       "tags_selected": [
//           "state",
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 31,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:25.665Z",
//       "guest_id": 15,
//       "query": "Please tell me what a prop is",
//       "tags_selected": [
//           "state",
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 32,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:26.177Z",
//       "guest_id": 15,
//       "query": "Please tell me what a prop is",
//       "tags_selected": [
//           "state",
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 33,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:26.486Z",
//       "guest_id": 15,
//       "query": "Please tell me what a prop is",
//       "tags_selected": [
//           "state",
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 34,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:26.797Z",
//       "guest_id": 15,
//       "query": "Please tell me what a prop is",
//       "tags_selected": [
//           "state",
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 35,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:27.098Z",
//       "guest_id": 15,
//       "query": "Please tell me what a prop is",
//       "tags_selected": [
//           "state",
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 36,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:27.350Z",
//       "guest_id": 15,
//       "query": "Please tell me what a prop is",
//       "tags_selected": [
//           "state",
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 37,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:27.664Z",
//       "guest_id": 15,
//       "query": "Please tell me what a prop is",
//       "tags_selected": [
//           "state",
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 38,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:27.815Z",
//       "guest_id": 15,
//       "query": "Please tell me what a prop is",
//       "tags_selected": [
//           "state",
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 39,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:28.124Z",
//       "guest_id": 15,
//       "query": "Please tell me what a prop is",
//       "tags_selected": [
//           "state",
//           "props",
//           "prop"
//       ]
//   },
//   {
//       "id": 40,
//       "room_id": 10,
//       "user_id": 8,
//       "guest_hash": "KkA",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:29.046Z",
//       "guest_id": 14,
//       "query": "What is flux?",
//       "tags_selected": [
//           "flux"
//       ]
//   },
//   {
//       "id": 41,
//       "room_id": 10,
//       "user_id": 11,
//       "guest_hash": "RZ9",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:36.213Z",
//       "guest_id": 17,
//       "query": "What are some examples of union selects ?",
//       "tags_selected": [
//           "sql",
//           "examples",
//           "union"
//       ]
//   },
//   {
//       "id": 42,
//       "room_id": 10,
//       "user_id": 11,
//       "guest_hash": "RZ9",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:33:58.433Z",
//       "guest_id": 17,
//       "query": "What came first ? The chicken or the egg ?",
//       "tags_selected": [
//           "sql",
//           "the",
//           "chicken",
//           "egg"
//       ]
//   },
//   {
//       "id": 43,
//       "room_id": 10,
//       "user_id": 0,
//       "guest_hash": "anon",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:34:32.124Z",
//       "guest_id": 18,
//       "query": "How many tequila shots can Juan take?",
//       "tags_selected": [
//           "tequila",
//           "shots",
//           "juan"
//       ]
//   },
//   {
//       "id": 44,
//       "room_id": 10,
//       "user_id": 0,
//       "guest_hash": "anon",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:34:38.822Z",
//       "guest_id": 18,
//       "query": "How many tequila shots can Juan take?",
//       "tags_selected": [
//           "tequila",
//           "shots",
//           "juan"
//       ]
//   },
//   {
//       "id": 45,
//       "room_id": 10,
//       "user_id": 0,
//       "guest_hash": "anon",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:34:51.376Z",
//       "guest_id": 18,
//       "query": "How many tequila shots can Juan take?",
//       "tags_selected": [
//           "tequila",
//           "shots",
//           "juan"
//       ]
//   },
//   {
//       "id": 46,
//       "room_id": 10,
//       "user_id": 11,
//       "guest_hash": "RZ9",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:34:58.646Z",
//       "guest_id": 17,
//       "query": ";^**173647929 !!? Testing special characters",
//       "tags_selected": [
//           "sql",
//           "testing",
//           "characters"
//       ]
//   },
//   {
//       "id": 47,
//       "room_id": 10,
//       "user_id": 0,
//       "guest_hash": "anon",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:35:03.358Z",
//       "guest_id": 18,
//       "query": "How many tequila shots can Juan take?",
//       "tags_selected": [
//           "tequila",
//           "shots",
//           "juan"
//       ]
//   },
//   {
//       "id": 48,
//       "room_id": 10,
//       "user_id": 11,
//       "guest_hash": "RZ9",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:35:16.975Z",
//       "guest_id": 17,
//       "query": "üêïüëçüëåüêùü•∂ü§îüôãüèª‚Äç‚ôÄÔ∏èüòí emoji test ",
//       "tags_selected": [
//           "sql",
//           "emoji"
//       ]
//   },
//   {
//       "id": 49,
//       "room_id": 10,
//       "user_id": 8,
//       "guest_hash": "KkA",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:36:39.616Z",
//       "guest_id": 14,
//       "query": "<script>alert('test');</script>",
//       "tags_selected": [
//           "<script>alert('test');</script>"
//       ]
//   },
//   {
//       "id": 50,
//       "room_id": 10,
//       "user_id": 8,
//       "guest_hash": "KkA",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:36:50.168Z",
//       "guest_id": 14,
//       "query": "<script>alert('test');</script>",
//       "tags_selected": [
//           "<script>alert('test');</script>"
//       ]
//   },
//   {
//       "id": 51,
//       "room_id": 10,
//       "user_id": 0,
//       "guest_hash": "anon",
//       "is_allowed": true,
//       "created_at": "2019-12-03T03:47:15.800Z",
//       "guest_id": 18,
//       "query": "What are stateless components?",
//       "tags_selected": []
//   }
// ]

// const guests =  [
//   {
//       "first_name": "Jenny",
//       "last_name": "Nguyen",
//       "id": 14,
//       "room_id": 10,
//       "user_id": 8,
//       "guest_hash": "KkA",
//       "is_allowed": true
//   },
//   {
//       "first_name": "Avi",
//       "last_name": "Choud",
//       "id": 15,
//       "room_id": 10,
//       "user_id": 9,
//       "guest_hash": "Wlp",
//       "is_allowed": true
//   },
//   {
//       "first_name": "Juan",
//       "last_name": "Carrera",
//       "id": 16,
//       "room_id": 10,
//       "user_id": 7,
//       "guest_hash": "D5F",
//       "is_allowed": true
//   },
//   {
//       "first_name": "Ha",
//       "last_name": "Pham",
//       "id": 17,
//       "room_id": 10,
//       "user_id": 11,
//       "guest_hash": "RZ9",
//       "is_allowed": true
//   },
//   {
//       "first_name": "Anonymous",
//       "last_name": null,
//       "id": 18,
//       "room_id": 10,
//       "user_id": 0,
//       "guest_hash": "anon",
//       "is_allowed": true
//   }
// ]


function getTotalQuestionsCount(questionArray){
  return questionArray.length
}



function getTotalGuestsCount(guestArray){
  return guestArray.length
}

function getTotalTagsCount(questionArray){
  let tagCount = 0;
  for(let question of questionArray){
    tagCount += question.tags_selected.length
  }
  return tagCount
}

function getIndividualTagsCount(questionArray){
  let tagCountObject = {}
  for(let question of questionArray){
    for(let tag of question.tags_selected){

      let tagUC = tag.toString().toUpperCase();
      if(tagCountObject[tagUC] === undefined){
        tagCountObject[tagUC] = 1
      } else {
        tagCountObject[tagUC]++
      }
    }
  }
  return tagCountObject
}



function getTotalQuestionsByGuestId(questionArray){
  let questionByGuestObject = {}
  for(let question of questionArray){
    if(questionByGuestObject[question.guest_id] === undefined){
      questionByGuestObject[question.guest_id] = 1
    } else {
      questionByGuestObject[question.guest_id]++
    }
  }
  return questionByGuestObject
}



function getQuestionsInvolvingTags(questionArray) {
  let tagQuestionsObject = {}
  for (let question of questionArray){
    for(let tag of question.tags_selected){
      let tagUC = tag.toString().toUpperCase();
      if(tagQuestionsObject[tagUC] === undefined){
        tagQuestionsObject[tagUC] = {questions: [question.query], count: 1}
      } else {
        tagQuestionsObject[tagUC] = {questions: [...tagQuestionsObject[tagUC].questions, question.query], count: tagQuestionsObject[tagUC]["count"] + 1}
      }
    }
  }
  return tagQuestionsObject
}


module.exports = {getTotalQuestionsCount, getTotalGuestsCount, getIndividualTagsCount, getTotalTagsCount, getTotalQuestionsByGuestId, getQuestionsInvolvingTags}